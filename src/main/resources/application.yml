server:
  port: 9080
spring:
  application:
    name: som-server-modulith
  cloud:
    config:
      import-check:
        enabled: false
  data:
    mongodb:
      database: SOMDB
      uri: mongodb://dragon:27017
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: "http://dragon:8180/realms/Springs%20of%20MUD"
resilience4j:
  circuitbreaker:
    instances:
      somAPI:
        slidingWindowType: COUNT_BASED
        slidingWindowSize: 20
        minimumNumberOfCalls: 10
        failureRateThreshold: 50
        waitDurationInOpenState: 10s
        permittedNumberOfCallsInHalfOpenState: 5
  retry:
    instances:
      somAPI:
        maxAttempts: 3
        waitDuration: 200ms
        exponentialBackoffMultiplier: 2
        retryExceptions:
          - org.springframework.dao.TransientDataAccessException
          - org.springframework.dao.RecoverableDataAccessException
        ignoreExceptions:
          - org.springy.som.modulith.domain.area.internal.InvalidAreaException
          - org.springy.som.modulith.domain.area.internal.AreaNotFoundException
          - org.springy.som.modulith.domain.character.internal.InvalidPlayerCharacterException
          - org.springy.som.modulith.domain.character.internal.PlayerCharacterNotFoundException
          - org.springy.som.modulith.domain.clazz.internal.InvalidClassException
          - org.springy.som.modulith.domain.clazz.internal.ClassNotFoundException
  bulkhead:
    instances:
      somAPI:
        maxConcurrentCalls: 50
        maxWaitDuration: 0
som:
  keycloak:
    base-url: "http://dragon:8180"
    realm: "Springs of MUD"
    client-id: "som-infra"
    client-secret: ENC(g5minpCM4mPgEtZfZk6CRigtBRTXwvroQpCutBR2qdV6BEtf0FiDwn/YGHE1kN4eSOHtqkr1WcVjXT/iBd2JjjJwGkUsWNCOKWTPOC1TeCwYl/q8gxhVtphPuHi3mmlEHr6Xb7gMd+kNsJ1vrqyAIVILKycGNdiyz+QHH/Gbo6inZrfJYd3GpgBhJsl4wETJG9bCcj0lim82xZs+wrPfTtMAjz5Bq1patSR9J8srvt7uuCNL50xoP0WQAoLOefd/7PGq0cl8kcVwZSNHYAViLixxnIQ7u76vZIIdh+KZbL2o3iGbSujlCWISFykk9o3mudXYSSmWsL5ksaXYnR7x0Q==)
    refresh:
      skew-seconds: 30
      poll-ms: 5000
      max-attempts: 8
      backoff-ms: 250
  crypto:
    key:
      alias: som-api
      password: ${KEYSTORE_PASSWORD}
    keystore:
      location: ${KEYSTORE_LOCATION}
      password: ${KEYSTORE_PASSWORD}
  web-security:
    enabled: false
  infra-api:
    username: som-infra
    password: ENC(RRqsiJFwkUa5BJgB3+dEv1bArwaYWRICOdBcfwPC2T61EaU7qWKS0nljvFIvUha7ORuxmh7IwA/SYXRNuRk14olvaI046bOjBjXproOnUEUId6nLyylk0rGlGcm7DYurai9+1cFhEOra3b/m9fSoLCr8BuLMSfpKtuUtb/s9UKMo1IxeMl/QTT2LhxJrjXyqgGaWaWN97DsSxOgmrT2mLN6vo9UeCJVzM4LiZSvTReEmZiLac5BRZ9ByGYlm1ISBpqujRi9jFE9X25rxKpuIsy6EA07rNVRJiJgJFKpTWEqOgm/nOnYuUtVXR9tQnWXwmycfF59RRNNIo9V+nm9s2Q==)
